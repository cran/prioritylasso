<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Simon Klau" />

<meta name="date" content="2017-09-25" />

<title>prioritylasso Vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">prioritylasso Vignette</h1>
<h4 class="author"><em>Simon Klau</em></h4>
<h4 class="date"><em>2017-09-25</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>prioritylasso was developed for situations in which different types of high dimensional omics-data in combination with clinical data are available. We want to include these so called blocks of data together in a prediction model. prioritylasso thereby tries to find a good compromise between prediction accuracy and practical aspects. This is done by letting the practitioner include prior knowlegde in the form of priorities, which define the importance of every block. The priorities can be chosen in several different ways.<br />
The model is successively calculated as LASSO-based, while the Linear Predictor after each fit is taken as an Offset in the LASSO Regression of the block with the next lowest priority. The Penalized Regression models are computed via the R package <code>glmnet</code>. Moreover, the R package <code>survival</code> is used when the outcome consists of survival data. In addition to the main function, the package <code>prioritylasso</code> contains an extension of the standard function named cvm_prioritylasso. It is also explained under practical aspects in the following examples.</p>
</div>
<div id="getting-started-with-prioritylasso" class="section level2">
<h2>Getting started with prioritylasso</h2>
<p>The data we will use for the examples was simulated and shall represent AML data with 4 blocks of variables. We first have to load the package which contains this data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(prioritylasso)</code></pre></div>
<p>To take a deeper look at the data, open the description through <code>?pl_data</code>. The different types of data are all stored together. To get and define the block structure which implies the priorities, we look at the names of the variables and the matrix dimension.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(pl_data)</code></pre></div>
<pre><code>## [1]  400 1029</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(pl_data)[<span class="dv">1</span>:<span class="dv">30</span>]</code></pre></div>
<pre><code>##  [1] &quot;b1.1&quot;  &quot;b1.2&quot;  &quot;b1.3&quot;  &quot;b1.4&quot;  &quot;b2.1&quot;  &quot;b2.2&quot;  &quot;b2.3&quot;  &quot;b2.4&quot; 
##  [9] &quot;b2.5&quot;  &quot;b3.1&quot;  &quot;b3.2&quot;  &quot;b3.3&quot;  &quot;b3.4&quot;  &quot;b3.5&quot;  &quot;b3.6&quot;  &quot;b3.7&quot; 
## [17] &quot;b3.8&quot;  &quot;b3.9&quot;  &quot;b3.10&quot; &quot;b3.11&quot; &quot;b3.12&quot; &quot;b3.13&quot; &quot;b3.14&quot; &quot;b3.15&quot;
## [25] &quot;b3.16&quot; &quot;b3.17&quot; &quot;b3.18&quot; &quot;b3.19&quot; &quot;b4.1&quot;  &quot;b4.2&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(pl_data)[<span class="dv">1025</span>:<span class="dv">1029</span>]</code></pre></div>
<pre><code>## [1] &quot;b4.997&quot;  &quot;b4.998&quot;  &quot;b4.999&quot;  &quot;b4.1000&quot; &quot;pl_out&quot;</code></pre>
<p>We see that the last column contains the outcome. We will re-save the outcome and the matrix of predictors seperately and define the argument <code>blocks</code> afterwards. We will need that for the application of prioritylasso where the indices have to correspond with the variables in the predictor matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl_out &lt;-<span class="st"> </span>pl_data[,<span class="dv">1029</span>]
pl_pred &lt;-<span class="st"> </span>pl_data[,<span class="dv">1</span>:<span class="dv">1028</span>]
blocks &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">bp1=</span><span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">bp2=</span><span class="dv">5</span>:<span class="dv">9</span>, <span class="dt">bp3=</span><span class="dv">10</span>:<span class="dv">28</span>, <span class="dt">bp4=</span><span class="dv">29</span>:<span class="dv">1028</span>)</code></pre></div>
<p>For an easier interpretation, we can consider the first block as clinical variables of most importance, the second block as other clinical data, and the third block as mutations. These blocks are all low-dimensional. That will later be an advantage regarding computation time. Another type of data is high dimensional gene expression data. Moreover, <code>pl_out</code> consists of a binary outcome for 400 subjects. Before we go further we want to split the data into training and validation set. The training set should be used to build the model with prioritylasso while the validation data should later be used to assess the prediction accuracy in an independent data set. Here we just do a random split such that 2/3 of the data belongs to the training set and 1/3 to the validation set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
label &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">dim</span>(pl_pred)[<span class="dv">1</span>],<span class="kw">round</span>(<span class="kw">dim</span>(pl_pred)[<span class="dv">1</span>]*(<span class="dv">2</span>/<span class="dv">3</span>)))
pl_train &lt;-<span class="st"> </span>pl_pred[label,]
pl_val &lt;-<span class="st"> </span>pl_pred[-label,]
pl_out_train &lt;-<span class="st"> </span>pl_out[label]
pl_out_val &lt;-<span class="st"> </span>pl_out[-label]</code></pre></div>
<p>We can now run prioritylasso for the first time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl1 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, 
                     <span class="dt">blocks =</span> blocks, <span class="dt">standardize =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Because we have a binary outcome, we specified <code>family = &quot;binomial&quot;</code> and <code>type.measure = &quot;auc&quot;</code>. The priority structure was given through the block definition in the data set. An extended use of the block definition and the general functionality of prioritylasso will be given in the following sections.</p>
</div>
<div id="prioritylasso---extended-application" class="section level2">
<h2>prioritylasso - extended application</h2>
<div id="specifying-the-priorities" class="section level4">
<h4>Specifying the priorities</h4>
<p>If we want to specify another block order, we have to redefine the argument <code>blocks</code>. Let us assume that we do not want to include the variables b1 first in the model, but b3 first, b1 second and b2 third. That would be done by <code>blocks = list(bp1 = 10:28, bp2 = 1:4, bp3 = 5:9, bp4 = 29:1028)</code>. So the position on the list indicates when the variables are considered in the model or in other words, the priority. It is not neccessary to name the entries of the list, but it may help in avoiding confusion. We chose the names such that “bp1”&quot; means “block of priority 1”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl2 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, 
                     <span class="dt">block1.penalization =</span> <span class="ot">TRUE</span>, <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>,  <span class="dv">29</span>:<span class="dv">1028</span>),
                     <span class="dt">standardize =</span> <span class="ot">FALSE</span>)
pl2$nzero</code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 1
## 
## [[4]]
## [1] 14</code></pre>
<p>The output lists are to be interpreted according to the definition in <code>blocks</code>. Therefore, the first entry corresponds to the variables of columns 10:28 in the data set.</p>
</div>
<div id="set-a-maximal-number-of-nonzero-coefficients." class="section level4">
<h4>Set a maximal number of nonzero coefficients.</h4>
<p>As we can see in pl2, we have a lot of nonzero coefficients of bp4, although it is the block with lowest priority. In general, there should be a reason why the glmnet procedure chooses these coefficients. On the other hand, it is sometimes not appropriate from a practical point of view that the number exceeds a particular value. Therefore we made it possible to set a maximal number of nonzero coefficients. Because we just want to set a limit for bp4, we set the other entries to <code>Inf</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl3 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, 
                     <span class="dt">block1.penalization =</span> <span class="ot">TRUE</span>, <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>,  <span class="dv">29</span>:<span class="dv">1028</span>), 
                     <span class="dt">max.coef =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>), <span class="dt">standardize =</span> <span class="ot">FALSE</span>)
pl3$nzero</code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 1
## 
## [[4]]
## [1] 9</code></pre>
</div>
<div id="include-the-block-with-the-highest-priority-without-a-penalty" class="section level4">
<h4>Include the block with the highest priority without a penalty</h4>
<p>We can further diversify the option of whether or not bp1 is included without a penalty in the model. In a not penalized version, the block has to be low-dimensional and the model includes all of its variables. In this case, the model fit is stored in <code>block1unpen</code>. Otherwise, the block is treated like the other blocks and a LASSO model is fitted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl4 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, 
                     <span class="dt">block1.penalization =</span> <span class="ot">FALSE</span>, <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                     <span class="dt">max.coef =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>), <span class="dt">standardize =</span> <span class="ot">FALSE</span>)
pl4$block1unpen</code></pre></div>
<pre><code>## 
## Call:  glm(formula = Y ~ X[, blocks[[1]]], family = family)
## 
## Coefficients:
##           b1.1    b1.2    b1.3    b1.4  
## 0.1220  1.2192  1.0789  0.4475  0.3029  
## 
## Degrees of Freedom: 266 Total (i.e. Null);  262 Residual
## Null Deviance:       352.1 
## Residual Deviance: 335.7     AIC: 345.7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl4$lambda.ind</code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## [1] 30
## 
## [[3]]
## [1] 19
## 
## [[4]]
## [1] 20</code></pre>
<p>The first entries of the values which correspond to the <code>blocks</code> list remain empty as you can see for the example of <code>lambda.ind</code>.</p>
</div>
<div id="options-for-the-cross-validation-procedure" class="section level4">
<h4>Options for the cross validation procedure</h4>
<p><code>nfolds</code> and <code>lambda.type</code> are options which refer to the cross-validation procedure in <code>cv.glmnet</code>. <code>nfolds</code> specifies the number of folds in the procedure while <code>lambda.type</code> handles the amount of cross-validation error. It can be set to either <code>lambda.min</code>, which is also the default, or <code>lambda.1se</code>. <code>lambda.min</code> gives the result with minimium mean cross-validation error, whereas <code>lambda.1se</code> gives the result such that the cross-validation error is within 1 standard error of the minimum, and thus leads to more sparse results. Note that the latter can only be chosen in combination with no restrictions in <code>max.coef</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl5_min &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, 
                         <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, <span class="dt">block1.penalization =</span> <span class="ot">TRUE</span>, 
                         <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                         <span class="dt">lambda.type =</span> <span class="st">&quot;lambda.min&quot;</span>, <span class="dt">standardize =</span> <span class="ot">FALSE</span>)

<span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl5_1se &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, 
                         <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, <span class="dt">block1.penalization =</span> <span class="ot">TRUE</span>, 
                         <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                         <span class="dt">lambda.type =</span> <span class="st">&quot;lambda.1se&quot;</span>, <span class="dt">standardize =</span> <span class="ot">FALSE</span>)

pl5_min$nzero</code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] 2
## 
## [[4]]
## [1] 11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl5_1se$nzero</code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] 0
## 
## [[4]]
## [1] 1</code></pre>
<p>In addition, other options for prioritylasso can be specified. For example, we can change the type of cross validation measurement for binary outcome to the misclassification error. Examples for other outcome variables are shown in the function documentation. Further arguments can be passed to prioritylasso which are used in <code>cv.glmnet</code>, e.g. the elasticnet mixing parameter. Here, we are only using the default value 1 which corresponds to the standard LASSO method, but a parameter <code>alpha</code> between 0 and 1 can be chosen as well.</p>
</div>
<div id="some-notes-on-the-output" class="section level4">
<h4>Some notes on the output</h4>
<p>The function used for every LASSO fit is glmnet which creates a sequence of lambda values. The lambda which is chosen according to <code>lambda.type</code> is the lambda on position <code>lambda.ind</code> of the sequence and its value is stored in <code>lambda.min</code>. In general, the lower the value of <code>lambda.ind</code>, the higher the <code>lambda.min</code> and thus the penalization. This leads to more sparse models. The number of <code>lambda</code> values can be chosen with an optional argument. We give the output of pl1 as an example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl1$lambda.ind</code></pre></div>
<pre><code>## [[1]]
## [1] 5
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 5
## 
## [[4]]
## [1] 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl1$lambda.min</code></pre></div>
<pre><code>## [[1]]
## [1] 0.02041998
## 
## [[2]]
## [1] 0.08908832
## 
## [[3]]
## [1] 0.01942847
## 
## [[4]]
## [1] 0.0641479</code></pre>
<p>The values of lambda are generated in every call of glmnet and hence cannot be compared. The corresponding mean cross validated error is stored in the list <code>min.cvm</code>. The interpretation of its values depend on the argument <code>type.measure</code>. In our examples with a binary outcome it is usually the area under the ROC curve (AUC).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl1$min.cvm</code></pre></div>
<pre><code>## [[1]]
## [1] 0.6328067
## 
## [[2]]
## [1] 0.6618344
## 
## [[3]]
## [1] 0.6875681
## 
## [[4]]
## [1] 0.7882044</code></pre>
<p>We see that for the example of pl1 it grows with the number of considered modalities. That is what we expected because the more coefficients we have in our model, the better the prediciton should be.</p>
</div>
</div>
<div id="use-of-the-function-cvm_prioritylasso" class="section level2">
<h2>Use of the function cvm_prioritylasso</h2>
<p>prioritylasso was generally implemented with the idea, that practitioners have prior knowledge about the data that allows them to specify the priorities. However, it might be, especially in the presence of several blocks, that it is not clear which order of blocks is the best. That is why we implemented cvm_prioritylasso that allows us to define more than one possible list of blocks. The function chooses the best block order according to the mean cross-validated error. Analogously, several vectors with maximal coefficients can be specified in <code>max.coef.list</code>. In the next example we do not know if it is better to include variables b4 before those of b3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
cvm_pl1 &lt;-<span class="st"> </span><span class="kw">cvm_prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, 
                             <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, <span class="dt">standardize =</span> <span class="ot">FALSE</span>, 
                             <span class="dt">block1.penalization =</span> <span class="ot">FALSE</span>, 
                             <span class="dt">blocks.list =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                                                <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">29</span>:<span class="dv">1028</span>, <span class="dv">10</span>:<span class="dv">28</span>)), 
                             <span class="dt">max.coef.list =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>), <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>, <span class="ot">Inf</span>)))
cvm_pl1$best.blocks</code></pre></div>
<pre><code>## [1] &quot;bp1 = 1:4&quot;     &quot;bp2 = 5:9&quot;     &quot;bp3 = 10:28&quot;   &quot;bp4 = 29:1028&quot;</code></pre>
<p>We see that the order of blocks which leads to the best result is specified first in <code>blocks.list</code>. It might be inconvenient to define a lot of lists in the block argument. Note that it is not the general idea of prioritylasso to be applied to any order of blocks and fish for the best.</p>
</div>
<div id="validation" class="section level2">
<h2>Validation</h2>
<p>Now we give a detailed example with a validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl_fit1 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, 
                         <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                         <span class="dt">block1.penalization =</span> <span class="ot">FALSE</span>, <span class="dt">max.coef =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>), 
                         <span class="dt">standardize =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>The idea before simulating the data was to include it in the order as it was defined in the data matrix. The first block, a block with only 4 variables should not be penalized. Because of prior knowledge (we have it because we generated the data, normally a practitioner could have it, too) we know that all of its variables are relevant. The maximal number of coefficients for the last block is restricted to 10. We can easily extract the coefficients and print those which are nonzero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coeff1 &lt;-<span class="st"> </span>pl_fit1$coefficients
coeff1 &lt;-<span class="st"> </span>coeff1[coeff1 !=<span class="st"> </span><span class="dv">0</span>]
<span class="kw">print</span>(<span class="kw">round</span>(coeff1, <span class="dv">4</span>))</code></pre></div>
<pre><code>##            b1.1    b1.2    b1.3    b1.4    b2.1    b2.3    b2.4    b2.5 
##  0.1220  1.2192  1.0789  0.4475  0.3029  0.1770  0.4689  0.0234 -0.1100 
##    b3.1    b3.2    b3.3    b3.4    b3.5    b3.7    b3.8   b3.11   b3.14 
## -0.4265 -0.1310 -0.2987  0.9576 -0.4942 -0.8483  0.1802 -0.0151 -0.0671 
##   b3.19    b4.1    b4.6   b4.10   b4.29  b4.106  b4.123  b4.269  b4.309 
##  0.3853  0.1346  0.2014  0.1676  0.0037  0.0480  0.0295  0.0611  0.1935 
##  b4.607  b4.623 
##  0.0230  0.0732</code></pre>
<p>We see that every variable from block 1 is nonzero, but we also have variables from every other block in our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pROC)</code></pre></div>
<p>The R package <code>pROC</code> gives a lot possibilities to evaluate and visualize the results. First we can calculate the score and the ROC curve in the training set and get an AUC value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl1_score &lt;-<span class="st"> </span>pl_train[ , <span class="kw">names</span>(coeff1)[-<span class="dv">1</span>], drop=F] %*%<span class="st"> </span>coeff1[-<span class="dv">1</span>]
pl1_roc &lt;-<span class="st"> </span><span class="kw">roc</span>(<span class="kw">factor</span>(pl_out_train), pl1_score[,<span class="dv">1</span>])
<span class="kw">auc</span>(pl1_roc)</code></pre></div>
<pre><code>## Area under the curve: 0.855</code></pre>
<p>Of course we can’t use this as a performance measure because it is estimated based on the data that was already used for training the model and is thus biased. A more appropriate value can be obtained with the test set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">val1_score &lt;-<span class="st"> </span>pl_val[ , <span class="kw">names</span>(coeff1)[-<span class="dv">1</span>], drop=F] %*%<span class="st"> </span>coeff1[-<span class="dv">1</span>]
val1_roc &lt;-<span class="st"> </span><span class="kw">roc</span>(<span class="kw">factor</span>(pl_out_val), <span class="kw">c</span>(val1_score))
<span class="kw">auc</span>(val1_roc)</code></pre></div>
<pre><code>## Area under the curve: 0.7439</code></pre>
<p>To investigate the influence of the priorities on the prediction accuracy, we can calculate the model again with another order of blocks and get the ROC curve in the same way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
pl_fit2 &lt;-<span class="st"> </span><span class="kw">prioritylasso</span>(<span class="dt">X =</span> pl_train, <span class="dt">Y =</span> pl_out_train, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, 
                         <span class="dt">type.measure =</span> <span class="st">&quot;auc&quot;</span>, <span class="dt">blocks =</span> <span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">10</span>:<span class="dv">28</span>, <span class="dv">5</span>:<span class="dv">9</span>, <span class="dv">29</span>:<span class="dv">1028</span>), 
                         <span class="dt">block1.penalization =</span> <span class="ot">FALSE</span>, <span class="dt">max.coef =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="ot">Inf</span>, <span class="dv">10</span>), 
                         <span class="dt">standardize =</span> <span class="ot">FALSE</span>)

coeff2 &lt;-<span class="st"> </span>pl_fit2$coefficients
coeff2 &lt;-<span class="st"> </span>coeff2[coeff2 !=<span class="st"> </span><span class="dv">0</span>]

val2_score &lt;-<span class="st"> </span>pl_val[ , <span class="kw">names</span>(coeff2)[-<span class="dv">1</span>], drop=F] %*%<span class="st"> </span>coeff2[-<span class="dv">1</span>]
val2_roc &lt;-<span class="st"> </span><span class="kw">roc</span>(<span class="kw">factor</span>(pl_out_val), <span class="kw">c</span>(val2_score))
<span class="kw">auc</span>(val2_roc)</code></pre></div>
<pre><code>## Area under the curve: 0.739</code></pre>
<p>We can plot the ROC curves and perform a paired test if the two AUC values are equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">roc.test</span>(val1_roc, val2_roc, <span class="dt">paired=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  DeLong's test for two correlated ROC curves
## 
## data:  val1_roc and val2_roc
## Z = 0.21872, p-value = 0.8269
## alternative hypothesis: true difference in AUC is not equal to 0
## sample estimates:
## AUC of roc1 AUC of roc2 
##   0.7438554   0.7390361</code></pre>
<p>The test result shows that we cannot reject the hypotheses that the AUC values are equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.roc</span>(val1_roc, <span class="dt">grid=</span><span class="fl">0.1</span>)
<span class="kw">plot.roc</span>(val2_roc, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;prioritylasso Score 1&quot;</span>, <span class="st">&quot;prioritylasso Score 2&quot;</span>),
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
